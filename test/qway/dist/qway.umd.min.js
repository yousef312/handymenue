!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).qway=i()}(this,function(){"use strict";function t(t=!1){var i=this;this.shortcutslist=[],this.combo=[],this.holdingActions=[],this.duplicates=t,this.KEYS=["command","ctrl","shift","alt","altGraph","capslock","tab","backspace","enter","meta","space","escape","pageup","pagedown","home","insert","delete","end","arrowup","arrowdown","arrowleft","arrowright","1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","*","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11"],this.shortcutActivated=!0,this.comboActivated=!0,this.intercativeMode=!1,this.toBuild=[[],[]],this.QEF=function(){},this.keysuite={},window.addEventListener("keydown",function(t){i.handleKeydown.call(i,t)}),window.addEventListener("keyup",function(t){i.handleKeyup.call(i,t)}),window.addEventListener("blur",function(){i.blur.call(i)})}return void 0===[].findIndex&&(Array.prototype.findIndex=function(t){var i=-1;for(let o=0;o<this.length;o++){const s=this[o];if(out=t(s,o,this),!0===out){i=o;break}}return i}),t.prototype={approve:function(){if(0!==this.toBuild[0].length){var t=this.toBuild[0].join("+"),i=this.toBuild[1][1];return this.bind(t,i),this.toBuild=[[],[]],t}},approveToReplace:function(){if(0===this.toBuild[0].length)return;var t=this.toBuild[0],i=this.toBuild[1][1],o=this.shortcutslist.find(t=>t.callback.toString()===i.toString());let s=-1!==this.check(t.join("+"));if(void 0!==o&&!s){this.unbind(o.shortcut.join("+"),o.callback);var e=this.bind(t.join("+"),this.toBuild[1][1]);return this.toBuild=[[],[]],this.intercativeMode=!1,!1===e?e:t}return this.toBuild=[[],[]],this.intercativeMode=!1,!1},abort:function(){this.intercativeMode=!1,this.toBuild=[[],[]]},resetCombo:function(t,i){t=this.supervise(t).join(",");var o=this.combo.findIndex(o=>o.combo.join(",")===t&&(void 0===i||void 0!==i&&o.callback.toString()===i.toString()));return-1!==o&&(this.combo[o].progress="",this.combo[o].done=!1,!0)},toggleCombo:function(t,i,o){t=this.supervise(t).join(",");var s=this.combo.findIndex(o=>o.combo.join(",")===t&&(void 0===i||void 0!==i&&o.callback.toString()===i.toString()));return-1!==s&&(this.combo[s].active="boolean"==typeof o?o:!this.combo[s].active,!0)},toggleShortcut:function(t,i,o){t=this.supervise(t).join("+");var s=this.shortcutslist.findIndex(o=>o.shortcut.join("+")===t&&(void 0===i||void 0!==i&&i.toString()===o.callback.toString()));return-1!==s&&(this.shortcutslist[s].active="boolean"==typeof o?o:!this.shortcutslist[s].active,!0)},replace:function(t,i){var o=this.shortcutslist.find(i=>void 0!==i.callback&&i.callback.toString()===t.toString());return void 0!==o&&(this.unbind(o.shortcut.join("+"),o.callback),this.bind(i,t))},getFromUser:function(t,i,o){this.intercativeMode=!0,this.toBuild[1].push(t,i,o)},stopGettingFromUser:function(){this.intercativeMode=!1,this.toBuild=[[],[]]},handleKeyup:function(t){var i=t.key.toLowerCase();if(i="control"===(i=" "===i?"space":i.trim())?"ctrl":i,this.keysuite[i]=!1,!1===this.intercativeMode){if(0!==this.shortcutslist.length){if(!1===this.shortcutActivated)return;this.shortcutslist.forEach(t=>{if(-1!==t.shortcut.indexOf(i))for(let o=t.shortcut.indexOf(i);o<t.shortcut.length;o++)t.progress[o]=!1}),0!==this.holdingActions.length&&this.holdingActions.forEach(t=>{t.key===i&&null!==t.timeout&&(clearTimeout(t.timeout),t.timeout=null)})}0!==this.combo.length&&!0===this.comboActivated&&this.combo.forEach((o,s)=>{-1===o.combo.indexOf(i)||o.done||!0!==o.active||(t.preventDefault(),o.progress+=i,null!==o.timeout&&clearTimeout(o.timeout),o.progress===o.combo.join("")&&(o.done=!0),o.callback(o),o.done||(o.timeout=setTimeout(function(){o.progress="",o.callback(o)},o.timing)))})}else{var o=this.toBuild[0].findIndex(t=>t===i);-1!==o&&(t.preventDefault(),this.toBuild[0].splice(o,1),this.toBuild[1][2](this.toBuild[0]))}},handleKeydown:function(t){var i=t.key.toLowerCase();if(i="control"===(i=" "===i?"space":i.trim())?"ctrl":i,this.keysuite[i]=!0,!1===this.intercativeMode){if(0!==this.shortcutslist.length&&!0===this.shortcutActivated&&this.shortcutslist.forEach(o=>{!1!==o.active&&("*"===o.shortcut[0]?(t.preventDefault(),o.progress[0]=!0):-1!==o.progress.indexOf(!0)&&"*"==o.shortcut[o.progress.lastIndexOf(!0)+1]&&(t.preventDefault(),o.progress[o.progress.lastIndexOf(!0)+1]=!0),-1!==o.shortcut.indexOf(i)&&(t.preventDefault(),!0!==o.progress[o.shortcut.indexOf(i)-1]&&void 0!==o.progress[o.shortcut.indexOf(i)-1]||(o.progress[o.shortcut.indexOf(i)]=!0)),!0===o.progress[o.progress.length-1]&&(t.preventDefault(),o.progress[o.progress.length-1]=!1,o.callback()))}),0!==this.holdingActions.length&&!0===this.shortcutActivated)for(let o=0;o<this.holdingActions.length;o++){const s=this.holdingActions[o];i===s.key&&null===s.timeout&&(t.preventDefault(),this.holdingActions[o].timeout=setTimeout(s.callback,s.duration))}}else if(!0===this.intercativeMode){-1===this.toBuild[0].findIndex(t=>t===i)&&(t.preventDefault(),this.toBuild[0].push(i),this.toBuild[1][2](this.toBuild[0]),this.toBuild[0].length===this.toBuild[1][0]&&(this.intercativeMode=!1,this.toBuild[1][2](this.toBuild[0],!0)))}},bind:function(t="ctrl+q",i,o=500){if("string"==typeof t){if(i="function"!=typeof i?this.QEF:i,o="number"!=typeof o?500:o,-1!==this.KEYS.indexOf(t)){var s={shortcut:[t],progress:[!1],callback:i,active:!0};return!(-1!==this.check(t)&&!this.duplicates)&&(this.shortcutslist.push(s),!0)}if(-1!==t.indexOf("+")){var e=this.supervise(t);if(!1!==t){s={shortcut:e,progress:new Array(e.length).fill(!1,0,e.length),callback:i,active:!0};return!(-1!==this.check(e.join("+"))&&!this.duplicates)&&(this.shortcutslist.push(s),!0)}return!1}if(-1!==t.indexOf(",")){var n=this.supervise(t);if(!1!==n){s={progress:"",combo:n,done:!1,callback:i,timing:o,timeout:null,active:!0};return!(-1!==this.check(n.join(","))&&!this.duplicates)&&(this.combo.push(s),!0)}return!1}if(-1!==t.indexOf("=>")){e=this.supervise(t);if(!1!==t){s={key:e[0],duration:e[1],callback:i,timeout:null};return!(-1!==this.check(t)&&!this.duplicates)&&(this.holdingActions.push(s),!0)}return!1}return!1}console.warn("Qway warn you:\nthe given shortcut not string!")},unbind:function(t,i){if(void 0===t)return this.shortcutslist=[],this.holdingActions=[],void(this.combo=[]);var o=!1;if(-1!==this.KEYS.indexOf(t))for(let s=this.shortcutslist.length-1;s>-1;s--){const e=this.shortcutslist[s];(void 0!==i&&e.callback.toString()===i.toString()||void 0===i)&&e.shortcut.join("")===t&&(this.shortcutslist.splice(s,1),o=!0)}else if(-1!==t.indexOf("+"))if("all"===i||void 0===i&&"+"===t)this.shortcutslist=[],o=!0;else{t=this.supervise(t).join("+");for(let s=this.shortcutslist.length-1;s>-1;s--){const e=this.shortcutslist[s];e.shortcut.join("+")===t&&(void 0!==i&&e.callback.toString()===i.toString()||void 0===i)&&(this.shortcutslist.splice(s,1),o=!0)}}else if(-1!==t.indexOf(","))if("all"===i||void 0===i&&","===t)this.combo=[],o=!0;else{t=this.supervise(t).join(",");for(let s=this.combo.length-1;s>-1;s--){const e=this.combo[s];e.combo.join(",")===t&&(void 0!==i&&e.callback.toString()===i.toString()||void 0===i)&&(this.combo.splice(s,1),o=!0)}}else if(-1!==t.indexOf("=>"))if("all"===i||void 0===i&&"=>"===t)this.holdingActions=[],o=!0;else{t=this.supervise(t);for(let s=this.holdingActions.length-1;s>-1;s--){const e=this.holdingActions[s];e.key===t[0]&&e.duration===t[1]&&(void 0!==i&&e.callback.toString()===i.toString()||void 0===i)&&(this.holdingActions.splice(s,1),o=!0)}}return o},check:function(t){return-1!==t.indexOf("+")?this.shortcutslist.findIndex(i=>void 0!==i&&i.shortcut.join("+")===t):-1!==t.indexOf(",")?this.combo.findIndex(i=>void 0!==i&&i.combo.join(",")===t):-1!==t.indexOf("=>")?this.holdingActions.findIndex(i=>void 0!==i&&i.key===t):this.shortcutslist.findIndex(i=>void 0!==i&&i.shortcut[0]===t)},supervise:function(t){if(-1!==t.indexOf(",")&&(-1!==t.indexOf("+")||-1!==t.indexOf("=>")))return!1;if(-1!==t.indexOf("+")&&(-1!==t.indexOf(",")||-1!==t.indexOf("=>")))return!1;if(-1!==t.indexOf("=>")&&(-1!==t.indexOf("+")||-1!==t.indexOf(",")))return!1;var i=!1;if(-1!==t.indexOf("+")){t=t.split("+");for(let o=0;o<t.length;o++)if("control"===t[o]&&(t[o]="ctrl")," "===t[o]&&(t[o]="space"),t[o]=t[o].toLowerCase(),-1===this.KEYS.indexOf(t[o])){i=!0;break}return!i&&t}if(-1!==t.indexOf(",")){t=t.split(",");var o=[];for(let e=0;e<t.length;e++){if(-1!==(s="control"===(s=" "===t[e]?"space":t[e].trim().toLowerCase())?"ctrl":s).indexOf("*")){if(s=s.split("*"),times=parseFloat(s[1]),name=s[0].trim(),-1===this.KEYS.indexOf(name)){i=!0;break}for(let t=0;t<times;t++)o.push(name)}else if(o.push(s),-1===this.KEYS.indexOf(s)){i=!0;break}}return!i&&o}if(-1!==t.indexOf("=>")){t=t.split("=>");var s,e=parseFloat(t[1]);return s="control"===(s=" "===(s=t[0])?"space":s.trim().toLowerCase())?"ctrl":s,-1!==this.KEYS.indexOf(s)&&(-1!==this.KEYS.indexOf(s)&&[s,e])}return t="control"===(t=" "===t?"space":t.trim().toLowerCase())?"ctrl":t,-1!==this.KEYS.indexOf(t)&&{shortcut:t,callback:null}},pack:function(){return{duplicates:this.duplicates,shortcut:this.shortcutslist,holdingActions:this.holdingActions,shortcutActivated:this.shortcutActivated,comboActivated:this.comboActivated,combo:this.combo}},initiate:function(t){this.duplicates=t.duplicates||!1,this.shortcutslist=t.shortcut||[],this.combo=t.combo||[],this.holdingActions=t.holdingActions||[],this.comboActivated=t.comboActivated||!0,this.shortcutActivated=t.shortcutActivated||!0},blur:function(){for(let t=0;t<this.shortcutslist.length;t++)this.shortcutslist[t].progress.fill(!1,0,this.shortcutslist[t].progress.length);for(let t=0;t<this.combo.length;t++)this.combo[t].progress="";for(let t=0;t<this.holdingActions.length;t++)null!==this.holdingActions[t].timeout&&(clearTimeout(this.holdingActions[t].timeout),this.holdingActions[t].timeout=null);this.intercativeMode=!1,this.toBuild=[[],[]]}},t});
//# sourceMappingURL=qway.umd.min.js.map
