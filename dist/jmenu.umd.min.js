!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).jmenu=t()}(this,(function(){"use strict";const e=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","keydown","keypress","keyup","focus","blur","focusin","focusout","submit","change","input","reset","select","touchstart","touchend","touchmove","touchcancel","pointerdown","pointerup","pointermove","pointerenter","pointerleave","pointercancel","dragstart","dragend","dragenter","dragover","dragleave","drop","resize","scroll","load","beforeunload","unload","play","pause","ended","volumechange","timeupdate","copy","cut","paste","animationstart","animationend","animationiteration","transitionstart","transitionend","DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","error","hashchange","popstate"],t=["<base>","<head>","<link>","<meta>","<style>","<title>","<body>","<address>","<article>","<aside>","<footer>","<header>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<main>","<nav>","<section>","<blockquote>","<dd>","<div>","<dl>","<dt>","<figcaption>","<figure>","<hr>","<li>","<ol>","<p>","<pre>","<ul>","<a>","<abbr>","<b>","<bdi>","<bdo>","<br>","<cite>","<code>","<data>","<dfn>","<em>","<i>","<kbd>","<mark>","<q>","<rp>","<rt>","<ruby>","<s>","<samp>","<small>","<span>","<strong>","<sub>","<sup>","<time>","<u>","<var>","<wbr>","<area>","<audio>","<img>","<map>","<track>","<video>","<embed>","<iframe>","<object>","<picture>","<portal>","<source>","<canvas>","<noscript>","<script>","<del>","<ins>","<caption>","<col>","<colgroup>","<table>","<tbody>","<td>","<tfoot>","<th>","<thead>","<tr>","<button>","<datalist>","<fieldset>","<form>","<input>","<label>","<legend>","<meter>","<optgroup>","<option>","<output>","<progress>","<select>","<textarea>","<details>","<dialog>","<summary>","<slot>","<template>"];function s(e){let t="";for(let s=0;s<e.length;s++){const n=e[s];n===n.toUpperCase()&&n!==n.toLowerCase()?t+="-"+n:t+=n}return t.toLowerCase()}const n=new WeakMap;function i(e,t){let s=[];for(const n in t){const r=t[n],[a,o]=n.split(":"),[u,...c]=a.split(".");let[h=null,p=null]=(o||"").split("-").map((e=>e.trim())),d=l(u.trim(),{class:c,parent:e,data:o?{value:h}:void 0});o&&h&&s.push({name:h,set(e,t){e.find(`[data-value="${h}"]`).textContent=t??p}}),!r||"object"!=typeof r||r instanceof Array||(s=s.concat(i(d,r)))}return s}let r=["click","submit","input","change","keydown","keyup","keypress","focusin","focusout","mouseover","mouseout"],a=(e,t,s)=>t;class o{#e=null;#t=new Map;#s={value:a,text:a};constructor(n,i,a){let l=this;if(n instanceof HTMLElement)this.#e=n;else if(t.includes(n))this.#e=document.createElement(n.substring(1,n.length-1));else{let e="!"===n.slice(-1);if(this.#e=document.querySelectorAll(e?n.slice(0,-1):n),0==this.#e.length)return null;(1==this.length||e)&&(this.#e=this.#e.item(0))}function u(e){let t=e.type,s=l.#t,n=e.target,i=this;if(s.has(t)){let r=s.get(t);r?.forEach((({callback:t,target:s})=>{n.closest(s)&&t(e,i)}))}}return this.each(((e,t)=>{let n=null;if(i)for(const t in i){const s=i[t];if("class"==t)e.classList.add.apply(e.classList,(s instanceof Array?s:s.split(" ")).filter((e=>""!=e)));else if("text"==t)e.textContent=s;else if("html"==t)e.innerHTML=s;else if("data"==t)for(const t in s)e.dataset[t]=s[t];else"parent"==t?n=s:t in e?e[t]=s:"_"!=t[0]&&e.setAttribute(t,e)}if(a)for(const t in a)-1!=t.indexOf("-")?e.style[t]=a[t]:e.style[s(t)]=a[t];(n instanceof o||n instanceof HTMLElement)&&n.append(e),r.forEach((t=>{e.addEventListener(t,u)}))})),e.forEach((e=>{l[e]=function(t){return t?"function"==typeof t&&l.on(e,t):l.trigger(e),l}})),this}get length(){return this.#e instanceof NodeList?this.#e.length:1}get raw(){return this.#e}each(e){return(this.#e instanceof NodeList?[...this.#e.entries()]:[[0,this.#e]]).forEach((([t,s])=>{e(s,t,this)})),this}html(e){let t;return this.each(((s,n)=>{if(void 0===e)return t=s.innerHTML;s.innerHTML=e})),null!=t?t:this}text(e){let t;return this.each(((s,n)=>{if(void 0===e)return t=this.#s.text("get",s.textContent,s);s.textContent=this.#s.text("set",e,s)})),null!=t?t:this}data(e,t){if(n.has(this)||n.set(this,{}),e){if(null==t)return n.get(this)[e];n.get(this)[e]=t}return this}attr(e,t){let s="";return this.each(((n,i)=>{if(0===e.indexOf("data-")){let[i,r]=e.split("-").map((e=>e.trim()));if(null==t)return s=n.dataset[r];n.dataset[r]=t}else if(e in n){if(null==t)return s=n[e];n[e]=t}else if("_"!=e[0]){if(null==t)return s=n.getAttribute(e);n.setAttribute(e,t)}})),s||this}class(e){let t;return this.each(((s,n)=>{if("number"==typeof e)return t=s.classList.item(e);e.split(" ").forEach((e=>{"-"==e[0]?s.classList.remove(e.substring(1,e.length)):"%"==e[0]?s.classList.toggle(e.substring(1,e.length)):"?"==e[0]?t=s.classList.contains(e.substring(1,e.length)):-1!=e.indexOf("/")?([v1,v2]=e.split("/"),s.classList.replace(v1,v2)):s.classList.add(e.substring(1,e.length))}))})),null!=t?t:this}show(e){return this.each(((t,s)=>{t.style.display=e??"inline-block"})),this}hide(e){return this.each(((t,s)=>{e?t.style.opacity=0:t.style.display="none"})),this}append(e,t){let s=[];if((Array.isArray(e)?e:[e]).forEach((e=>{e instanceof o?s.push(e.#e):e instanceof HTMLElement&&s.push(e)})),this.#e instanceof NodeList)return console.warn("[EyeJS] beware while using .append with multi selected elements"),this.#e.forEach(((e,t)=>{s[t]&&e.append(s[t])})),this;if(t)switch(t){case"next":case"after":this.#e.after(...s);break;case"previous":case"before":this.#e.before(...s)}else this.#e.append(...s);return this}after(e){return(this.#e instanceof NodeList?this.#e.item(0):this.#e).after(e),this}before(e){return(this.#e instanceof NodeList?this.#e.item(0):this.#e).before(e),this}replaceWith(...e){let t=[];return(Array.isArray(e)?e:[e]).forEach((e=>{e instanceof o?t.push(e.#e):e instanceof HTMLElement&&t.push(e)})),this.#e instanceof NodeList?[...this.#e.entries()].forEach((([e,s])=>{t[e]&&s.replaceWith(t[e])})):this.#e.replaceWith(...t),this}parent(e){if(e){if(!(e instanceof HTMLElement||e instanceof o))throw new Error("[EyeJS] Unable to append current element to parent because it's not HTMLElement");return this.each(((t,s)=>{e.append(t)})),this}return l(this.#e instanceof NodeList?this.#e.item(0).parentElement:this.#e.parentElement)}is(e,t){if(e=e instanceof o?e.#e:e,this.#e instanceof NodeList)return console.warn("[EyeJS] .is is not functional with multi selected elements"),this;if("connected"===e)return this.#e.isConnected;switch(t){case"same":return this.#e.isSameNode(e);case"equal":return this.#e.isEqualNode(e);default:return console.error(`[EyeJS] Unknown check "${t}", possible values are ["same","equal","connected"]`),!1}}css(e,t){if(e){let n;return e=s(e),this.each(((s,i)=>{if(void 0===t)return n=s.style[e];s.style[e]=t})),null!=n?n:this}return console.error('[EyeJS] mission argument "attr" in function .css')}remove(){return this.each(((e,t)=>{e.remove()})),this}on(e,t,s){e=e.split(" ");let n="string"==typeof t?t:null,i="function"==typeof t?t:s,a=this;if("function"!=typeof i)return console.error("[EyeJS] .on method is missing the actuall callback `cb` or not of type function");let o=this.#e instanceof NodeList?[...this.#e.entries()]:[[0,this.#e]],l=null;return e.forEach((e=>{if(n){if(!r.includes(e))return l=e;a.#t.has(e)||a.#t.set(e,new Set),a.#t.get(e).add({callback:i,target:n})}else o.forEach((([t,s])=>{s.addEventListener(e,i)}))})),null!==l?console.error(`[EyeJS] trying to use delegation for an inappropriate event "${l}"`):this}off(e,t){let s=this.#t;if("function"!=typeof t)return console.error("[EyeJS] .off method is missing the actuall callback `cb` or not of type function");e=e.split(" "),this.each(((s,n)=>{e.forEach((e=>s.removeEventListener(e,t)))})),e.forEach((e=>{if(s.has(e)){let n=s.get(e);for(const e of n)t===e.callback&&n.delete(e)}}))}trigger(e){return this.each(((t,s)=>{t.dispatchEvent(function(e,t={}){switch(e){case"click":case"dblclick":case"mousedown":case"mouseup":case"mousemove":case"mouseenter":case"mouseleave":case"mouseover":case"mouseout":return new MouseEvent(e,t);case"pointerdown":case"pointerup":case"pointermove":case"pointerenter":case"pointerleave":case"pointerover":case"pointerout":return new PointerEvent(e,t);case"keydown":case"keyup":case"keypress":return new KeyboardEvent(e,t);case"focus":case"blur":case"focusin":case"focusout":return new FocusEvent(e,t);case"input":case"change":case"submit":case"reset":return new Event(e,t);case"wheel":return new WheelEvent(e,t);case"copy":case"cut":case"paste":return new ClipboardEvent(e,t);case"scroll":case"resize":return new UIEvent(e,t);default:return new CustomEvent(e,t)}}(e))})),this}find(e){let t=[];return this.each(((s,n)=>{s.querySelectorAll(e).forEach((e=>t.push(e)))})),1==t.length?t[0]:t}clone(e){if(this.#e instanceof NodeList){let t=[];return this.#e.forEach((e=>{t.push(e.cloneNode(!0))})),(e instanceof HTMLElement||e instanceof o)&&t.forEach((t=>e.append(t))),t}{let t=this.#e.cloneNode(!0);return(e instanceof HTMLElement||e instanceof o)&&e.append(t),t}}compute(e){return"bounds"===(e=e||"bounds")?(this.#e instanceof NodeList?this.#e.item(0):this.#e).getBoundingClientRect():"style"==e?getComputedStyle(this.#e instanceof NodeList?this.#e.item(0):this.#e):void console.error(`[EyeJS] unkown type "${e}" in function .compute, possible values are "bounds" "style"`)}pointer(e,t,s){return this.each(((n,i)=>{"capture"===e?!0===t?n.setPointerCapture(s):n.releasePointerCapture(s):"lock"===e&&(!0===t?n.requestPointerLock():document.exitPointerLock())})),this}child(e){let t=this.#e instanceof NodeList?this.#e.item(0):this.#e;return void 0===e?t.children.length:t.children[e]?l(t.children[e]):null}val(e){if(null==e){let e=this.#e instanceof NodeList?this.#e.item(0):this.#e;return this.#s.value("get",e.value,e)}return(this.#e instanceof NodeList?[...this.#e.entries()]:[[0,this.#e]]).forEach((([t,s])=>s.value=this.#s.value("set",e,s))),this}serialize(e){e=e||{};let{inputs:t=["input","textarea","select"]}=e;if(this.#e instanceof HTMLElement){let s={json:{},url:"",fd:new FormData};return this.#e.querySelectorAll(t.join(",")).forEach(((t,n)=>{let i=t.name||t.dataset.name,r=t.value||t.textContent;"function"==typeof e[i]&&(r=e[i](t)),"file"==t.type?t.files.forEach((e=>{s.fd.append(i,e)})):(s.json[i]=r,s.fd.append(i,r))})),s.url=new URLSearchParams(s.json).toString(),s}console.warn("[EyeJS] this is a multi selection, it's not serializable!")}redefine(e,t){return["text","value"].includes(e)&&"function"==typeof t&&(this.#s[e]=t),this}animate(e,t){let s=[];return t.duration=t.duration||1e3,this.each(((n,i)=>{s.push(n.#e.animate(e,t))})),1==s.length?s[0]:s}}function l(e,t,s){if("string"==typeof e&&0===e.indexOf("model:")||"model"===e){if(!t)return console.error("[EyeJS] Model creation requires parameter 'attr' as prototype, none delivered!");let s=["eye-model"];(e=e.split(":"))[1]&&(s=s.concat(e[1].split(" ").filter((e=>""!=e))));let n=l("<div>",{class:s.join(" ")}),r=i(n,t);return e=>{let t=l(n.clone(e?.parent));return t.refresh=function(e={}){let s=!1!==e.default;return r.forEach((n=>{(!0===s||!s&&e.hasOwnProperty(n.name))&&n.set(t,e[n.name])})),this},t.refresh(e)}}return new o(e,t,s)}window.eye=l;const u=()=>{};let c=0;const h={separator:l("model:jmenu-menu-item separator",{"<span>: _label":{}}),normal:l("model:jmenu-menu-item",{"<div>.p1":{},"<div>.p2":{"<div>: _label":{},"<div>: _accelerator":{}},"<div>.p3":{}})};class p extends CustomEvent{#n=null;#i=null;constructor(e,t,s){super(e,{bubbles:!1,cancelable:!1}),this.#n=t,this.#i=s}get menu(){return this.#n}get which(){return this.#i}}class d{#r=!0;value=null;constructor(e,t){this.menu=e,this.button=null,this.label=t.label||"New Button "+ ++c,this.func=t.func||u,this.type=t.type||"button",this.icon=t.icon,this.accelerator=t.accelerator||null,this.properties=t,this.runtime={},this.#a()}#a(){const e=this.menu.props.spacing;let t=this;if("separator"==this.type)this.button=h.separator({parent:this.menu.elm,_label:this.label});else{let s=this.button=h.normal({parent:this.menu.elm,_label:this.label,_accelerator:this.accelerator}),n=s.child(0),i=s.child(1),r=s.child(2),a=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:e;n.css("width",`${a}px`).css("backgroundImage",this.icon?`url(${this.icon})`:""),r.css("width",`${o}px`);let u=i.child(0),c=i.child(1),p=null,d=null,m=null,b=null,w=null;switch(this.type){case"button":d=function(e){!1!==t.func(t,e)&&t.menu.close(!0)};break;case"check-box":let e=Array.isArray(this.label)?this.label:[this.label,this.label];u.text(e[0]);let a=l("<div>",{class:"jmenu-check-box-mark"});this.runtime.checkBoxMark=a,this.selected=!1,d=function(){!0===t.selected?(t.selected=!1,a.remove(),i.child(0).text(e[0])):(t.selected=!0,n.append(a),i.child(0).text(e[1])),!1!==t.func(t.selected,t)&&t.menu.close()};break;case"radio-button":if(!this.properties.name)throw new Error("[JmenuJS] Error:\n Radio boxes buttons definition must contain name attribute!");this.menu.radios[this.properties.name]||(this.menu.radios[this.properties.name]={ball:l("<div>",{class:"jmenu-radio-button-mark"})},n.append(this.menu.radios[this.properties.name].ball)),!0===this.properties.default&&n.append(this.menu.radios[this.properties.name].ball),d=function(){let e=t.menu.radios[t.properties.name];e.ball&&n.append(e.ball),!1!==t.func(t.label,t)&&t.menu.close()};break;case"definition":let o=l("<div>",{class:"jmenu-definition-box",parent:document.body,html:this.properties.def},{display:"none"});this.runtime.defBloc=o,c.text("definition"),m=function(){let e=this.getBoundingClientRect(),t=e.left+e.width+5,s=e.top;window.innerWidth-(e.left+e.width)<200&&(t=e.left-205),o.css("left",`${t}px`).css("top",`${s}px`).css("display","inline-block")},b=()=>o.css("display","none");break;case"slider":let h=this.properties.format=this.properties.format||"_value_",g=this.properties.step=this.properties.step||1,y=this.properties.range=this.properties.range||[0,100];s.class("+jmenu-slider"),c.class("+jmenu-slider-btns");let v=l("<div>",{class:"jmenu-slider-btn"});c.append(v);let E=l("<div>",{class:"jmenu-slider-show"});c.append(E);let k=l("<div>",{class:"jmenu-slider-btn"});c.append(k),l("<div>",{class:"jmenu-minus",parent:v}),l("<div>",{class:"jmenu-plus1",parent:k}),l("<div>",{class:"jmenu-plus2",parent:k}),this.value=this.properties.default||y[0],E.text(h.replace("_value_",this.value)),v.click((function(){t.#r&&(t.value=Math.max(t.value-g,y[0]),E.text(h.replace("_value_",t.value)),t.func(t.value,t))})),k.click((function(){t.#r&&(t.value=Math.min(t.value+g,y[1]),E.text(h.replace("_value_",t.value)),t.func(t.value,t))})),!0===this.properties.wheel&&(w=function(e){e.preventDefault(),e.deltaY>=0?v.click():k.click()});break;case"submenu":c.class("+jmenu-menu-item-arrow"),p=new f(this.properties.submenu,{action:"none",parent:this.menu,alignToTarget:"left",alignToOffset:2}),this.menu.submenus.push(p),m=function(){this.tm=setTimeout((function(){let e=r.compute();p.popup({x:e.left+e.width-3,y:e.top},s.raw)}),500)},b=function(){this.tm&&clearTimeout(this.tm)}}"function"==typeof d&&s.click((e=>{t.#r&&d(e)})),"function"==typeof m&&s.mouseenter(m),"function"==typeof b&&s.mouseleave(b),"function"==typeof w&&s.on("wheel",w),s.mouseenter((function(){for(let e=0;e<t.menu.submenus.length;e++)t.menu.submenus[e].close()})),this.properties.disabled&&this.disable()}}setValue(e){"slider"==this.type&&"number"==typeof e&&(this.value=e<this.properties.range[0]?this.properties.range[0]:e>this.properties.range[1]?this.properties.range[1]:e,this.button.child(1).child(1).child(1).text(this.properties.format.replace("_value_",this.value)))}enable(){this.#r=!0,this.button.attr("style",!1)}disable(){this.#r=!1,this.button.css("background-color","transparent").css("color","gray").css("pointer-action","none").css("cursor","default")}}class f{def=null;props={};elm=null;target=window;#o=[];#l=null;radios={};submenus=[];computed={menuHeight:0,menuWidth:0,parent:null};untouchable=null;#u={};constructor(e,t){this.def=e,t||(t={});let{target:s=window,action:n="contextmenu",bars:i=5,spacing:r=30,parent:a=null,alignToTarget:o=null,alignToOffset:u=0}=t,c=this;this.target=s??window,this.computed.parent=a,this.props={target:s,action:n,bars:i,spacing:r,alignToTarget:o,alignToOffset:u},a?this.untouchable=a.untouchable:(this.untouchable=l("<div>",{class:"jmenu-untouchable",parent:document.body}),this.untouchable.mousedown((function(){c.close()}))),this.create(),this.bindEvents(),this.#c()}get which(){return this.#l}bindEvents(){let e=(this.props.action??"contextmenu").split(" "),t=this;e.forEach((e=>{"string"==typeof t.target?window.addEventListener(e,(function(e){e.target.closest(t.target)&&(e.preventDefault(),t.popup({x:e.clientX,y:e.clientY},e.target))})):t.target.addEventListener(e,(function(e){e.preventDefault(),t.popup({x:e.clientX,y:e.clientY},e.target)}))}))}create(){let e=l("<div>",{class:["jmenu-menu","unselect"],parent:document.body}),t=this;this.elm=e;let s=0,n=0;"number"==typeof this.props.bars?s=n=this.props.bars:Array.isArray(this.props.bars)&&(s=this.props.bars[0],n=this.props.bars[1]),e.css("padding-top",s+"px"),e.css("padding-bottom",n+"px"),this.elm.css("display","none"),this.def.forEach((e=>{t.addButton(e)}))}addButton(e){let t=new d(this,e);this.#o.push(t)}get buttons(){return this.#o}popup(e,t){let{x:s,y:n}=e,i=this.props.alignToTarget;if(this.#l=t,[!0,"left","right"].includes(i)){let e=this.props.alignToOffset,r=t.getBoundingClientRect();[!0,"left"].includes(i)&&r.left+r.width+this.computed.menuWidth>window.innerWidth?i="right":"right"==i&&r.left-this.computed.menuWidth<0&&(i="left"),"left"===i||!0===i?s=r.left+r.width+2-e:"right"===i&&(s=r.left-this.computed.menuWidth-2+e),n=r.top+this.computed.menuHeight>window.innerHeight?r.top+r.height-this.computed.menuHeight:r.top}else n+this.computed.menuHeight>window.innerHeight-20&&(n=window.innerHeight-(20+this.computed.menuHeight)),s+this.computed.menuWidth>window.innerWidth-20&&(s=window.innerWidth-(20+this.computed.menuWidth));this.elm.css("left",s+"px"),this.elm.css("top",n+"px"),this.elm.css("position","fixed"),this.elm.css("display","inline-block"),this.untouchable&&this.untouchable.show("inline-block"),this.trigger("open",new p("open",this,t))}close(e){if(e&&this.computed.parent)return this.computed.parent.close(!0);0!=this.submenus.length&&this.submenus.forEach((e=>e.close())),this.elm.css("display","none"),this.computed.parent||this.untouchable.hide(),this.trigger("close",new p("close",this,window))}#c(){this.elm.css("left",-9999),this.elm.css("position","fixed"),this.elm.css("display","inline-block");let e=this.elm.compute();this.computed.menuHeight=e.height,this.computed.menuWidth=e.width,this.elm.css("display","none")}hideButton(e){this.#o[e]&&this.#o[e].button.hide()}showButton(e){this.#o[e]&&this.#o[e].button.show("flex")}enableButton(e){this.#o[e]&&this.#o[e].enable()}disableButton(e){this.#o[e]&&this.#o[e].disable()}setButtonProp(e,t,s){if(this.buttons[e]){let n=this.buttons[e];switch(t){case"label":n.label=s,n.button.refresh({default:!1,_label:s});break;case"value":n.setValue(s);break;case"icon":"separator"!=n.type&&n.button.child(0).css("backgroundImage",s);break;case"accelerator":["slider","separator","definition"].includes(n.type)||n.button.refresh({default:!1,_accelerator:s});break;case"definition":"definition"==n.type&&n.runtime.defBloc.html(n.properties.def=s)}}}on(e,t){Array.isArray(this.#u[e])||(this.#u[e]=[]),this.#u[e].push(t)}off(e,t){if(Array.isArray(this.#u[e])){let s=this.#u[e].findIndex((e=>t===e));-1!=s&&this.#u[e].splice(s,1)}}trigger(e,...t){let s=this;Array.isArray(this.#u[e])&&this.#u[e].forEach((e=>e.call(s,...t)))}}return console.warn("[JmenuJS] Don't forget to link the css file bundled with the library to get full functional menus!"),f}));
//# sourceMappingURL=jmenu.umd.min.js.map
